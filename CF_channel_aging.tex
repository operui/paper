\documentclass[journal]{IEEEtran}
%\documentclass[12pt, draftclsnofoot, onecolumn]{IEEEtran}
%\documnetclass[10pt, conference]{IEEEtran}
\usepackage{graphicx,amssymb,amsmath}%包库,graphicx是导入图片需要的
\usepackage{multicol}%媒芦赂
\usepackage[noadjust]{cite}%cite引用
\usepackage{setspace}%碌梅没戮
\usepackage{stfloats}
\usepackage{algorithm}

%\usepackage{midfloat}
%\usepackage[normal]{threeparttable}
\usepackage{amsthm}
\usepackage{amsmath}%test
\usepackage{flushend}
%\usepackage[normal]{threeparttable}
%\usepackage{balance}
%\usepackage{cuted}
\usepackage{cases,subeqnarray}
\usepackage{bm,multirow,bigstrut}
\usepackage{textcomp}
\usepackage{latexsym,bm}
\usepackage{booktabs,changebar}
\usepackage{xcolor}
\usepackage{mathtools}
\usepackage{dsfont}
\usepackage{extarrows}
\usepackage{mathrsfs}
%\usepackage[square,comma,sort&compress,numbers]{natbib}% 多个文献引用，需要加包头
\usepackage{cite}
\usepackage{bm}
\usepackage{cleveref}

%\usepackage[nolists,nomarkers]{endfloat}
%\doublespacing
% \setlength{\textfloatsep}{10pt plus 1.0pt minus 2.0pt}
%\setlength{\floatsep}{10pt plus 1.0pt minus 2.0pt}
%\usepackage[top=0.5in, bottom=0.5in, left=0.5in, right=0.5in]{geometry}
\theoremstyle{plain}
\newtheorem{thm}{Theorem}
\newtheorem{lemm}{Lemma}
\theoremstyle{plain}
\newtheorem{rem}{Remark}



%\newtheorem{lemm}{Lemma}
%\newtheorem{them}{Theorem}
\newtheorem{coro}{Corollary}
%\newtheorem{prop}{Proposition}
\usepackage{CJK}
%\usepackage[top=2cm, bottom=2cm, left=2cm, right=10cm]{geometry}

\usepackage{algorithm}%放在开头
\usepackage{algorithmicx}
\usepackage{algpseudocode}
\floatname{algorithm}{Algorithm}




\IEEEoverridecommandlockouts
\begin{document}%文档开始
\title{Cell-Free Massive MIMO with Channel Aging}
\author{Jiayi~Zhang,~\IEEEmembership{Member,~IEEE,~}% 作者名字
        Yinghua Wei,~
        Emil~Bj\"{o}rnson,~\IEEEmembership{Senior Member,~IEEE}

\thanks{This work was supported in part by the National Natural Science Foundation of China (Grant No. 61601020), the Beijing
Natural Science Foundation (Grant Nos. 4182049 and L171005), and the open research fund of National Mobile Communications Research Laboratory, Southeast University (Grant No. 2018D04). The work of E. Bj\"{o}rnson was supported by ELLIIT and SSF.}
\thanks{J. Zhang, Y. Wei are with the School of Electronic and Information Engineering, Beijing Jiaotong University, Beijing 100044, P. R. China (e-mail: jiayizhang@bjtu.edu.cn).}
\thanks{E. Bj\"{o}rnson is with the Department of Electrical Engineering (ISY), Link\"{o}ping University, Link\"{o}ping, Sweden.}
}

\maketitle

\begin{abstract}
Cell-free massive multiple-input multiple-output (MIMO), with a large number of distributed access points (APs) that jointly serve all the user equipments (UEs), is a promising wireless access technology for future wireless networks. While prior works have considered block-fading channels, real channels are gradually changing over time. Cell-free massive MIMO systems can utilize the gradual channel aging for more efficient operation. In this paper, we study the spectral and energy efficiency of cell-free massive MIMO systems with the presence of channel aging. For the uplink, with maximum radio combining (MRC) receivers, we derive a tight closed-form lower bound on the spectral and energy efficiency. Furthermore, we investigate the impact of channel aging on the power scaling law. The transmit power of UE can be scaled down by $1/ {\sqrt M }$ (where $M$ is the number of APs). Our results show that the channel aging does not degrade the power scaling law but only the spectral and energy efficiency values.
\end{abstract}
\begin{IEEEkeywords}
Cell-free massive MIMO, spectral efficiency, energy efficiency, channel aging.
\end{IEEEkeywords}

%\newpage
\IEEEpeerreviewmaketitle
\section{Introduction}
Cellular massive multiple-input multiple-output (MIMO), which deploys a large number of antennas per cell to spatially multiplex a large number of users, has generated much interest since the seminal paper \cite{marzetta2010noncooperative}. Cellular massive MIMO is able to achieve high spectral and energy efficiency with simple linear signal processing \cite{zhang2018low}. The antenna arrays of cellular massive MIMO have two kinds of topologies: multiple geographically distributed antenna arrays or a co-located antenna array in the cell center \cite{interdonato2018ubiquitous}. The common feature of both topologies is that each cell serves an designated set of UEs. Unfortunately, UEs at the cell edges may suffer from strong interference and pilot contamination from neighboring cells. Therefore, the system performance is typically limited by inter-cell interference.

In order to solve this problem, the cell-free massive MIMO concept has been proposed as the future network architecture. The concept builds on having a huge number of access points (APs) that jointly serve all the UEs by phase-coherent processing. This is basically a revamp of the network MIMO concept \cite{zhou2003distributed}. To make the network operation scalable, a time-division duplex (TDD) protocol is used, and only utilize locally estimated channels are used at each AP \cite{Ngo2016Cell}. The difference between cell-free massive MIMO and network MIMO is the analytical approach, borrowed from cellular massive MIMO, which facilitates the capacity analysis and efficient power control. One outstanding aspect of cell-free massive MIMO is that it significantly outperforms conventional small-cell systems in terms of 95$\%$ likely per-user throughput \cite{Ngo2016Cell}.

Recently, there has been a great deal of interest in cell-free massive MIMO. For example, the authors in \cite{nayebi2017precoding} presented a max-min power control algorithm with linear zero-forcing (ZF) precoding for cell-free massive MIMO. In \cite{nayebi2016performance}, the authors investigated the uplink performance of cell-free massive MIMO systems with large scale fading decoding (LSFD) receivers, and derived an asymptotic approximation for signal-to-interference-plus-noise ratio (SINR) of MMSE receivers. In \cite{Ngo2016Cell,Ngo2015Cell}, the impacts of pilot assignment and power control on the cell-free massive MIMO system has been investigated, and it is indicated that cell-free massive MIMO nearly provides fivefold improvement per-UE throughput over small cell systems. The conditions under which channel hardening and favorable propagation appear have been studied in \cite{Chen2017Channel}. In \cite{nguyen2017energy,ngo2018total}, the authors presented a novel low-complexity power control algorithm of cell-free massive MIMO to maximize energy efficiency (EE) with ZF precoding. In \cite{Zhang2017spectral}, the authors derived closed-from expressions for the uplink spectral efficiency (SE), taking the effect of low-quality transceiver hardware into consideration. A mixed quality-of-service (QoS) problem of cell-free massive MIMO with a predefined UE's rate has been considered in \cite{bashar2018mixed}. These prior works have significantly enhanced our knowledge on cell-free massive MIMO systems.

However, all the prior works on cell-free massive MIMO have assumed block-fading channels, which have a fixed realization in a coherence block and then a new independent realization in the next block. In contrast, practical channels change gradually over time, which leads to the channel aging effect, where the channel is estimated at one point in time and then changes while the estimated channel is still being used \cite{truong2013effects}. Although the impact of channel aging on the performance of massive MIMO systems has been investigated adequately in \cite{chopra2018performance,papazafeiropoulos2017performance,Kong2015sumrate} for independent and identically distributed (i.i.d.) Rayleigh fading channels, its effect on cell-free massive MIMO systems has not yet been considered. \textcolor{blue}{Moreover, the shadowing model has not been addressed in \cite{truong2013effects}.}

In order to fill this gap, we investigate the uplink performance of cell-free massive MIMO systems with channel aging. The specific contributions of this paper are as follows:
\begin{itemize}
\item We obtain a closed-form expression for the uplink SE of cell-free massive MIMO systems with a realistic channel aging model. The derived expression explicitly reveals how channel aging affects the SE.
\item We derive a useful power scaling law, which establishes a precise relationship between transmit power and the number of APs with the negligible loss in the uplink SE.
\item A closed-form EE expression is derived to show the optimal number of APs for maximizing the EE with different channel aging parameters, which is useful for the design of cell-free massive MIMO systems.
\end{itemize}


\section{System Model}\label{se:channel aging model}
We consider the uplink of cell-free massive MIMO systems, which is composed of $M$ APs and $K$ noncooperative UEs. The APs and UEs are equipped with a single antenna. For the ${n}$th symbol time, the received signal at the $m$th AP is given by
\begin{equation}\label{CAYm}
{y_m}\left[ n \right] = \sqrt {{p_u}} \sum\limits_{k = 1}^K {{g_{mk}}\left[ n \right]{q_k}\left[ n \right]}  + {w_m}\left[ n \right],
\end{equation}
where ${{g_{mk}}\left[ n \right]}$ denotes the channel coefficient between the $m$th AP and the $k$th UE, ${{p_u}}$ is the average transmit power of a UE, ${{q_k}\left[ n \right]}$ is the transmit symbol of the $k$th UE with unit power, ${w_m}\left[ n \right]$ is the zero-mean additive white Gaussian noise (AWGN) with unit variance.

Considering both large- and small-scale fading, the channel coefficient ${g_{mk}}\left[ n \right]$ models the propagation as follows:
\begin{equation}
{g_{mk}}\left[ n \right] = {h_{mk}}\left[ n \right]\sqrt {{\beta _{mk}}},
\end{equation}
where ${h_{mk}}\left[ n \right]$ represents the small-scale fading coefficient for the link from the $k$th UE to the $m$th AP, and ${{\beta _{mk}}}$ models the large-scale fading including shadowing and path loss.

\subsection{Channel Estimation}
The APs estimate the channels using uplink pilots. \textcolor{blue}{We assume that UEs take turn on sending pilots, the $k$th UE sends its pilot at the time slot $k$, which would avoid issues where every symbol of a pilot sequence is sent over a different channel.} Let $\tau$ denote the length of the training period, and the received pilot signal at the $m$th AP is given by
\begin{equation}\label{Ypm-CA}
{{\mathbf{y}}_{pm}}\left[ n \right] = \sqrt {{p_{\text{p}}}\tau } \sum\limits_{k' = 1}^K {{g_{mk'}}\left[ n \right]{{\bm{\varphi }}_{k'}}}  + {{\mathbf{w}}_m}\left[ n \right],
\end{equation}
where ${p_p}$ denotes the transmit power of the pilots. Based on the received pilot vector ${{\mathbf{y}}_{pm}}\left[ n \right]$, the $m$th AP estimates the channel coefficient ${{g_{mk}}\left[ n \right]}$. Utilizing the projection of ${{\mathbf{y}}_{pm}}\left[ n \right]$ onto ${\bm{\varphi }}_k^H$, we obtain ${{\overset{\lower0.5em\hbox{$\smash{\scriptscriptstyle\smile}$}}{y} }_{pm}}\left[ n \right]$ as
\begin{align}
  {{\overset{\lower0.5em\hbox{$\smash{\scriptscriptstyle\smile}$}}{y} }_{pm}}\left[ n \right]&=\frac{1}{{\sqrt {{p_p}\tau } }}{\bm{\varphi }}_k^H{{\mathbf{y}}_{pm}}\left[ n \right]  \notag\\
   &= \sum\limits_{k' = 1}^K {{g_{mk'}}\left[ n \right]{\bm{\varphi }}_k^H{{\bm{\varphi }}_{k'}}}  + \frac{1}{{\sqrt {{p_p}\tau } }}{\bm{\varphi }}_k^H{{\mathbf{w}}_m}\left[ n \right],
\end{align}
Moreover, ${g_{mk}}\left[ n \right]$ can be decomposed into
\begin{equation}
{g_{mk}}\left[ n \right] = {{\hat g}_{mk}}\left[ n \right] + {{\tilde g}_{mk}}\left[ n \right].
\end{equation}
The MMSE estimate of ${{g_{mk}}\left[ n \right]}$ given ${{\overset{\lower0.5em\hbox{$\smash{\scriptscriptstyle\smile}$}}{y} }_{pm}}\left[ n \right]$ is
\begin{align}
{{\hat g}_{mk}}\left[ n \right] &= \frac{{\mathbb{E}\{ \overset{\lower0.5em\hbox{$\smash{\scriptscriptstyle\smile}$}}{y} _{pm}^*\left[ n \right]{g_{mk}}\left[ n \right]\} }}{{\mathbb{E}\{ {{\left| {{{\overset{\lower0.5em\hbox{$\smash{\scriptscriptstyle\smile}$}}{y} }_{pm}}\left[ n \right]} \right|}^2}\} }}{{\overset{\lower0.5em\hbox{$\smash{\scriptscriptstyle\smile}$}}{y} }_{pm}}\left[ n \right] \notag \\
&= {c_{mk}}\left[ n \right]{{\overset{\lower0.5em\hbox{$\smash{\scriptscriptstyle\smile}$}}{y} }_{pm}}\left[ n \right],
\end{align}
where
\begin{align}\label{Cmk-lamda}
{c_{mk}}\left[ n \right] &\triangleq \frac{{{\beta _{mk}}}}{{\sum\limits_{k' = 1}^K {{\beta _{mk'}}{{\left| {{\mathbf{\varphi }}_k^H{{\mathbf{\varphi }}_{k'}}} \right|}^2}}  + \frac{1}{{{p_{\text{p}}}\tau }}}},\notag \\
{\lambda _{mk}}\left[ n \right] &\triangleq \mathbb{E}\left\{ {{{\left| {{{\hat g}_{mk}}\left[ n \right]} \right|}^2}} \right\} = {c_{mk}}\left[ n \right]{\beta _{mk}}.
\end{align}

\subsection{Channel Aging}
We adopt the channel aging model proposed in \cite{truong2013effects} to investigate the impact of channel aging. The channel for the $k$th UE at time $n+1$ can be written through an autoregressive model of order 1 as
\begin{equation}
{g_{mk}}\left[ {n + 1} \right] = \alpha {g_{mk}}\left[ n \right] + {e_{mk}}\left[ {n + 1} \right],
\end{equation}
where ${e_{mk}}\left[ {n + 1} \right]\sim \mathcal{CN}\left( {0,\left( {1 - {\alpha ^2}} \right){\beta _{mk}}} \right)$ is a temporally uncorrelated complex white Gaussian noise process, and $\alpha$ denotes a temporal correlation parameter. In practice,we consider the Jakes fading model, and have $\alpha  = {J_0}\left( {2\pi {f_D}{T_s}} \right)$, where ${J_0}\left(  \cdot  \right)$ is the zero-order first kind Bessel function, ${f_D} = \frac{{v{f_c}}}{c}$ is the maximum Doppler frequency shift determined by the UE' velocity $v$, carrier frequency ${{f_c}}$ and the sped of light $c$, ${{T_s}}$ is the channel sampling duration. Considering the properties of the Bessel function, we can easily get $0 \leqslant \left| \alpha  \right| \leqslant 1$. Furthermore, the channel aging effect becomes more serious with smaller the $\left| \alpha  \right|$.
To this end, considering the combined effects of the channel aging effect and the channel estimation errors, we can write
\begin{equation}
{g_{mk}}\left[ {n + 1} \right]{\text{ = }}\alpha {{\hat g}_{mk}}\left[ n \right] + \underbrace {\alpha {{\tilde g}_{mk}}\left[ n \right] + {e_{mk}}\left[ {n + 1} \right]}_{{{\tilde e}_{mk}}\left[ {n + 1} \right]},
\end{equation}
where ${{{\tilde e}_{mk}}\left[ {n + 1} \right]}\sim \mathcal{CN}\left( {0,{\beta _{mk}} - {\alpha ^2}\frac{{{p_p}\tau \beta _{mk}^2}}{{1{\text{ + }}{p_p}\tau {\beta _{mk}}}}} \right)$ is independent with ${{\hat g}_{mk}}\left[ n \right]$ due to the independence between ${{{\tilde g}_{mk}}\left[ n \right]}$, ${{e_{mk}}\left[ {n + 1} \right]}$ and ${{\hat g}_{mk}}\left[ n \right]$.

\section{Uplink Performance Analysis}\label{se:uplink-CA}
\subsection{Uplink Spectral Efficiency}
Due to the slowly changing large-scale effect and UE mobility, it is reasonable to assume that the large-scale fading ${{\beta _{mk}}}$ and the temporal correlation parameter $\alpha $ are known at the APs \cite{Kong2015sumrate}. Hence, the $m$th AP has the following CSI as
\begin{equation}\label{gmk-estimate}
{{\bar g}_{mk}}\left[ {n + 1} \right] = \alpha {{\hat g}_{mk}}\left[ n \right].
\end{equation}
Let ${{\hat a}_{mk}}\left[ {n + 1} \right]$ be the linear detector signal. We consider a simple linear receivers MRC, ${{\hat a}_{mk}}\left[ {n + 1} \right] = {{\bar g}_{mk}}\left[ {n + 1} \right]$, and the received signal multiplying ${\hat a_{mk}^H\left[ {n + 1} \right]}$ with ${{y_m}\left[ {n + 1} \right]}$ from (\ref{Ypm-CA}) as follows
\begin{align}\label{rk-CA}
  &{r_k}\left[ {n + 1} \right] = \sum\limits_{m = 1}^M {\hat a_{mk}^H\left[ {n + 1} \right]{y_m}\left[ {n + 1} \right]}  \hfill \notag\\
   &= \sqrt {{p_u}} \sum\limits_{m = 1}^M {\hat a_{mk}^H\left[ {n + 1} \right]{{\bar g}_{mk}}\left[ {n + 1} \right]{q_k}\left[ {n + 1} \right]}  \hfill \notag\\
  & + \sqrt {{p_u}} \sum\limits_{m = 1}^M {\hat a_{mk}^H\left[ {n + 1} \right]\sum\limits_{k' \ne k}^K {{{\bar g}_{mk'}}\left[ {n + 1} \right]{q_{k'}}\left[ {n + 1} \right]} }  \hfill \notag\\
   &+ \sqrt {{p_u}} \sum\limits_{m = 1}^M {\hat a_{mk}^H\left[ {n + 1} \right]\sum\limits_{k' = 1}^K {\left( {{g_{mk'}}\left[ {n + 1} \right] - {{\bar g}_{mk'}}\left[ {n + 1} \right]} \right){q_{k'}}\left[ {n + 1} \right]} }  \hfill \notag \\
  & + \sum\limits_{m = 1}^M {\hat a_{mk}^H\left[ {n + 1} \right]{w_m}\left[ {n + 1} \right]}  \hfill
\end{align}
\newcounter{mytempeqncnt1}
\begin{figure*}[b]
\normalsize
\setcounter{mytempeqncnt1}{\value{equation}}
\hrulefill
\vspace*{0pt}
\setcounter{equation}{11}
\begin{align}\label{Rk-CA}
{R_k} = {\log _2}\left( {1 + \frac{{{p_u}{\alpha ^2}{{\left| {\sum\limits_{m = 1}^M {{\lambda _{mk}}\left[ n \right]} } \right|}^2}}}{{{p_u}{\alpha ^2}\sum\limits_{m = 1}^M {\sum\limits_{k' \ne k}^K {{\lambda _{mk}}\left[ n \right]{\lambda _{mk'}}\left[ n \right]} }  + \sum\limits_{m = 1}^M {{\lambda _{mk}}\left[ n \right]\left( {{p_u}\sum\limits_{k' = 1}^K {\left( {{\beta _{mk'}} - {\alpha ^2}\frac{{{p_p}\tau \beta _{mk'}^2}}{{1{\text{ + }}{p_p}\tau {\beta _{mk'}}}}} \right)}  + 1} \right)} }}} \right).
\end{align}
\setcounter{equation}{\value{mytempeqncnt1}}
\end{figure*}
\addtocounter{equation}{1}




\textcolor{blue}{It is clear that (\ref{rk-CA}) includes four parts: the target signal from the $k$th UE, the inter-UE interference, the channel error interference and the compound noise. The combined error ${{g_{mk}}\left[ {n + 1} \right] - {{\bar g}_{mk}}\left[ {n + 1} \right]}$ is treated as uncorrelated Gaussian noise. According to ${{\hat a}_{mk}}\left[ {n + 1} \right] = {{\bar g}_{mk}}\left[ {n + 1} \right]$ and using (\ref{Cmk-lamda}), (\ref{gmk-estimate}), we can get the SE of the $k$th UE as \eqref{Rk-CA} at the bottom of next page.} Then, we present the power scaling law in the following theory.
%\begin{equation}\label{Rk-CA}
%{R_k} = {\log _2}\left( {1 + \frac{{{p_u}{\alpha ^2}{{\left| {\sum\limits_{m = 1}^M {{\lambda _{mk}}\left[ n \right]} } \right|}^2}}}{{{p_u}{\alpha ^2}\sum\limits_{m = 1}^M {\sum\limits_{k' \ne k}^K {{\lambda _{mk}}\left[ n \right]{\lambda _{mk'}}\left[ n \right]} }  + \sum\limits_{m = 1}^M {{\lambda _{mk}}\left[ n \right]\left( {{p_u}\sum\limits_{k' = 1}^K {\left( {{\beta _{mk'}} - {\alpha ^2}\frac{{{p_p}\tau \beta _{mk'}^2}}{{1{\text{ + }}{p_p}\tau {\beta _{mk'}}}}} \right)}  + 1} \right)} }}} \right)
%\end{equation}
\begin{thm} \label{theorem1-CA}
 With aged CSI, if each UE scales down its transmit power proportionally to $1/{M^\gamma}$, i.e., ${p_u} = {E_u}/{M^\gamma }$, ${p_p} = {E_u}/{M^\gamma }$, where ${E_u}$ is fixed and $\gamma  > 0$, we have
\begin{equation}\label{theorem1-R-CA}
R_k - {\log _2}\left( {1 + \frac{{\tau {\alpha ^2}E_u^2\beta _{mk}^2}}{{{M^{2\gamma  - 1}}}}} \right)\xrightarrow{{M \to \infty }}0
\end{equation}
\newcounter{mytempeqncnt}
\begin{figure*}[b]
\normalsize
\setcounter{mytempeqncnt}{\value{equation}}
\hrulefill
\vspace*{0pt}
\setcounter{equation}{13}
\begin{align}\label{Rk-mrc-CA}
{R_k} = \rm{\mathbb{E}}\left\{ {{{\log }_2}\left( {1 + \frac{{\frac{{{\alpha ^2}{E_u}}}{{{M^\gamma }}}\frac{1}{{{M^2}}}\sum\limits_{m = 1}^M {{{\left| {{{\hat g}_{mk}}\left[ n \right]} \right|}^4}} }}{{\frac{{{\alpha ^2}{E_u}}}{{{M^\gamma }}}\frac{1}{{{M^2}}}\sum\limits_{m = 1}^M {\sum\limits_{k' \ne k}^K {{{\left| {\hat g_{mk}^H\left[ n \right]{{\hat g}_{mk'}}\left[ n \right]} \right|}^2}} }  + \left( {\frac{{{E_u}}}{{{M^\gamma }}}\sum\limits_{k' = 1}^K {{\delta _{k'}}}  + 1} \right)\frac{1}{{{M^2}}}\sum\limits_{m = 1}^M {{{\left| {\hat g_{mk}^H\left[ n \right]} \right|}^2}} }}} \right)} \right\},
\end{align}
\setcounter{equation}{\value{mytempeqncnt}}
\end{figure*}
\addtocounter{equation}{1}

\begin{IEEEproof}
Substituting ${{\hat a}_{mk}}\left[ {n + 1} \right] = {{\bar g}_{mk}}\left[ {n + 1} \right] = \alpha {{\hat g}_{mk}}\left[ n \right]$ and ${p_u} = {E_u}/{M^\gamma }$, ${p_p} = {E_u}/{M^\gamma }$ into (\ref{Rk-CA}), we obtain \eqref{Rk-mrc-CA} at the bottom of this page,
%\begin{equation}\label{Rk-mrc-CA}
%{R_k} = \rm{\mathbb{E}}\left\{ {{{\log }_2}\left( {1 + \frac{{\frac{{{\alpha ^2}{E_u}}}{{{M^\gamma }}}\frac{1}{{{M^2}}}\sum\limits_{m = 1}^M {{{\left| {{{\hat g}_{mk}}\left[ n \right]} \right|}^4}} }}{{\frac{{{\alpha ^2}{E_u}}}{{{M^\gamma }}}\frac{1}{{{M^2}}}\sum\limits_{m = 1}^M {\sum\limits_{k' \ne k}^K {{{\left| {\hat g_{mk}^H\left[ n \right]{{\hat g}_{mk'}}\left[ n \right]} \right|}^2}} }  + \left( {\frac{{{E_u}}}{{{M^\gamma }}}\sum\limits_{k' = 1}^K {{\delta _{k'}}}  + 1} \right)\frac{1}{{{M^2}}}\sum\limits_{m = 1}^M {{{\left| {\hat g_{mk}^H\left[ n \right]} \right|}^2}} }}} \right)} \right\},
%\end{equation}
where
\begin{equation}
{\delta _k} \triangleq {\beta _{mk}} - {\alpha ^2}\frac{{\frac{{{E_u}}}{{{M^\gamma }}}\tau \beta _{mk}^2}}{{1{\text{ + }}\frac{{{E_u}}}{{{M^\gamma }}}\tau {\beta _{mk}}}}.
\end{equation}
To this end, ${M \to \infty }$, invoking the law of large numbers, we obtain
\begin{equation}
\frac{1}{M}\left| {\hat g_{mk}^\dag \left[ n \right]{{\hat g}_{mk}}\left[ n \right]} \right| - \left\{ \begin{gathered}
  \frac{{\tau \frac{{{E_u}}}{{{M^\gamma }}}\beta _{mk}^2}}{{1{\text{ + }}\tau \frac{{{E_u}}}{{{M^\gamma }}}{\beta _{mk}}}},i = k \hfill \\
  0,{\text{                  }}i \ne k \hfill \\
\end{gathered}  \right.\xrightarrow{{M \to \infty }}0.
\end{equation}
We also have
\begin{equation}
\frac{{{\alpha ^2}{E_u}}}{{{M^\gamma }}}\sum\limits_{k' = 1}^K {\left( {{\beta _{mk}} - {\alpha ^2}\frac{{\tau \frac{{{E_u}}}{{{M^\gamma }}}\beta _{mk}^2}}{{1{\text{ + }}\tau \frac{{{E_u}}}{{{M^\gamma }}}{\beta _{mk}}}}} \right)}  + 1 \to 1.
\end{equation}
Then, (\ref{Rk-mrc-CA}) reduces to
\begin{equation}
{R_k} - {\log _2}\left( {1 + \frac{{\tau {\alpha ^2}E_u^2\beta _{mk}^2}}{{{M^{2\gamma  - 1}}}}} \right)\xrightarrow{{M \to \infty }}0,
\end{equation}
which proves (\ref{theorem1-R-CA}).
\end{IEEEproof}
\end{thm}

\begin{coro}\label{coro1}
With aged CSI, each UE can scale down its transmit power at most by ${p_u} = {E_u}/\sqrt M $, ${p_p} = {E_u}/\sqrt M $ for a fixed ${E_u}$, and the SE becomes
\begin{equation}
{R_k} \to {\log _2}\left( {1 + \tau {\alpha ^2}E_u^2\beta _{mk}^2} \right),\;\;\;M \to \infty
\end{equation}
\end{coro}
Corollary 1 suggests a very encouraging result, that channel aging does not affect the power scaling law, it only leads to a reduction of the SE.

\subsection{Energy Efficiency}
In the following, we investigate the EE of cell-free massive MIMO systems. The EE (bit/Joule) is the ratio of the sum rate (bit/s) to the sum of power consumption (Watt) of the system. As in \cite{ngo2018total}, we adopt a realistic power consumption model where the total power consumption is comprise of the power consumption of the transmitters, receivers, and backhaul. More specifically, the total power consumption is modeled as
 \begin{eqnarray}\label{power1}
{P_\textrm{total}} = \sum\limits_{k = 1}^K {{P_k}}  + \sum\limits_{m = 1}^M {{P_m}}  + \sum\limits_{m = 1}^M {{P_{b,m}}} ,
 \end{eqnarray}
where ${P_k}$ denotes the power consumption at the $k$th UE (including the radiated transmission power and the circuit power), ${{P_m}}$ is the circuit power consumption at the $m$th AP (including transceiver chains and digital signal processing), and ${{P_{b,m}}}$ denotes the power consumed by the backhaul link connecting the $m$th AP and CPU. Then, the EE can be modeled as
\begin{equation}\label{EE-CA-Equation}
\text{EE} = \frac{{\sum\limits_{k = 1}^K {{R_k}}  \cdot B}}{{\sum\limits_{k = 1}^K {{P_k}}  + \sum\limits_{m = 1}^M {{P_m}}  + \sum\limits_{m = 1}^M {{P_{b,m}}} }}
\end{equation}

\section{Numerical Results}
\begin{figure}[t]
\centering
\includegraphics[scale=0.41]{PuChange180118.eps}
\caption{Uplink sum-rate versus the transmit power ${p_u}$ for $K = 10$, $M = 100$.}
\label{SECA}
\end{figure}

Fig.~\ref{SECA} investigates the tightness of the Monte Carlo simulation and analytical SE in (\ref{Rk-CA}), and we demonstrate their tightness. In addition, it is clear that channel aging degrades the SE, which validates our results in Theorem 1.
\begin{figure}[t]
\centering
\includegraphics[scale=0.41]{MChange180118.eps}
\caption{Uplink sum-rate against the number of APs for different correlation parameter $\alpha$.}
\label{MchangeCA}
\end{figure}

In Fig.~\ref{MchangeCA}, the Monte Carlo simulated and analytical average SE are compared as a function of the number of APs. It is clear to see that both curves are almost the same for all considered cases. The average SE is an increasing function of $M$. The SE decreases when the correlation parameter $\alpha $ decreases.

\begin{figure}[t]
\centering
\includegraphics[scale=0.41]{PuScalingLaw.eps}
\caption{Uplink sum-rate as a function of the number of APs with aged CSI for $K=10$, ${p_u} = {E_u}/{M^\gamma }$ and ${E_u}=15$ dB.}
\label{PuscalingLaw}
\end{figure}

Fig.~\ref{PuscalingLaw} validates the power scaling law of cell-free massive MIMO systems with aged CSI. We find that when $\gamma  > {1 \mathord{\left/
 {\vphantom {1 2}} \right. \kern-\nulldelimiterspace} 2}$, i.e., $\gamma  = 1.5$ the SE decreases gradually, and converges to zero. In addition, when $\gamma  < {1 \mathord{\left/ {\vphantom {1 2}} \right. \kern-\nulldelimiterspace} 2}$, i.e., $\gamma  = 0.1$, SE increase with the increase of $M$. When $\gamma  = {1 \mathord{\left/ {\vphantom {1 2}} \right. \kern-\nulldelimiterspace} 2}$, we see that, SE increase slowly with $M$ increase compared to $\gamma  = 0.1$.
\begin{figure}[t]
\centering
\includegraphics[scale=0.41]{EE180129.eps}
\caption{Uplink EE as a function of the number of APs for different correlation parameter $\alpha$.}
\label{EE-CA}
\end{figure}

Fig.~\ref{EE-CA} investigates the EE in \eqref{EE-CA-Equation} as a function of the number of APs for different values of $\alpha $. We consider $K = 10$, ${P_k} = 0.6$\,W, ${P_m} = 0.1$\,W, and ${P_{b,m}} = 0.1$\,W. We observe that the EE decreases when decreases $\alpha$, for the same number of APs, due to the stronger channel aging effect. There is a value ${M^{\text{opt}}}$ that provides maximum EE. For $\alpha=1$, this value is ${M^{\text{opt}}}=20$. When $M \leqslant {M^{\text{opt}}}$, the EE can be improved by increasing $M$. However, when $M > {M^{\text{opt}}}$, increasing $M$ will rapidly reduce the EE. This is due to the fact that only a few APs have a large impact on the SE of a UE, thus adding more APs will increase the power consumption linearly, while the sum SE might increase more slowly.

\vspace{-2mm}
\section{Conclusion}\label{se:conclusion}
In this paper, we investigate the effect of channel aging on the performance of cell-free massive MIMO systems with MRC receivers. Closed-form expressions for the SE and EE were derived, which reveal how the performance depends on the transmit power, correlation parameters, the number of APs $M$. Furthermore, a power scaling law was obtain, which proves that SE converges to a non-zero limit when the transmit power of each UE can be scaled down by ${1 /{\sqrt M }}$ considering channel aging.
\bibliographystyle{IEEEtran}
\bibliography{IEEEabrv,Ref}
\end{document}

